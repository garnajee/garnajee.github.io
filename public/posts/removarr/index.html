<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>Removarr | Garnajee</title><meta name=keywords content="removarr,Flask,Python,server,web,app"><meta name=description content="A web app to list and delete files in your download folder but not in your media folder."><meta name=author content="Garnajee"><link rel=canonical href=http://localhost:1313/posts/removarr/><link crossorigin=anonymous href=/assets/css/stylesheet.18363bccfea088cced466eada344517aca36d3ee0ccd04441ff7d5e14343d8d9.css integrity="sha256-GDY7zP6giMztRm6to0RReso20+4MzQREH/fV4UND2Nk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/removarr/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Garnajee (Alt + H)">Garnajee</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/posts title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/about title=About><span>About</span></a></li><li><a href=http://localhost:1313/contact title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>All posts</a></div><h1 class=post-title>Removarr</h1><div class=post-meta><span title='2023-04-25 13:27:56 +0200 CEST'>April 25, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Garnajee</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#about aria-label=About>About</a><ul><li><a href=#how-it-works aria-label="How it works">How it works</a><ul><li><a href=#proof-it-works aria-label="Proof it works">Proof it works</a></li></ul></li><li><a href=#how-to-install aria-label="How to install">How to install</a></li><li><a href=#todo aria-label=Todo>Todo</a></li><li><a href=#build aria-label=Build>Build</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=about>About<a hidden class=anchor aria-hidden=true href=#about>#</a></h1><p>The <a href=https://github.com/garnajee/removarr>source code</a> is available on github.</p><p>This is a web application, created to help you manually delete files present in the (e.g. Transmission <code>completed/</code>) download folder but not in the (e.g. Jellyfin) <code>medias/</code> folder. If you have separated folders it&rsquo;ll also works.</p><p>Take a look at the screenshot of the web-app <a href="https://zupimages.net/viewer.php?id=23/37/0wll.png">here</a>.</p><h2 id=how-it-works>How it works<a hidden class=anchor aria-hidden=true href=#how-it-works>#</a></h2><p>A recursive comparison according to the inodes of the files is made between the <code>completed/</code> (download) folder (e.g. on the Transmission side) and the folders where the media are stored (e.g. on the Jellyfin side).</p><p>Example 1:</p><pre tabindex=0><code>├── completed       # Transmission side
│   ├── folder1
│   ├── ...
│   ├── files
│   └── ...
└── medias          # Jellyfin side
    ├── movies
    │   ├── folders
    │   └── ...
    └── series
        ├── folders
        └── ...
</code></pre><p>Example 2:</p><pre tabindex=0><code>├── completed       # Transmission side
│   ├── folder1
│   ├── ...
│   ├── files
│   └── ...
├── movies          # Jellyfin side
│   ├── files
│   ├── folders
│   │   └── ...
│   └── ...
└── series          # Jellyfin side
    ├── files
    └── folders
        └── ...
</code></pre><p>All the files present on the side of Jellyfin are the latest versions that we want to keep. So, all we want to remove is everything that is present on the Transmission side but not on the Jellyfin side.</p><p>If the deleted file was in a folder:</p><ul><li>if the folder is now empty, then the folder is deleted</li><li>if the folder does not contain other files with extension &lsquo;.mkv&rsquo;, &lsquo;.mp4&rsquo;, &lsquo;.avi&rsquo;, &lsquo;.mov&rsquo;, then the folder is deleted</li><li>if the folder does not contain subfolder(s), the folder is deleted</li></ul><h3 id=proof-it-works>Proof it works<a hidden class=anchor aria-hidden=true href=#proof-it-works>#</a></h3><p>I&rsquo;m using this app on a Synology NAS.</p><p>I have 2x6TB HDD in RAID 1. The filesystem of my main volume (<code>/volume1</code>) is in <code>Btrfs</code>.</p><p>To try if the file was properley deleted and if I recovered the storage, I ran this command before and after the deletion of the file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ btrfs <span style=color:#66d9ef>fi</span> usage /volume1/ -g
</span></span></code></pre></div><p>I deleted a file of about <strong>1,9 GB</strong>. Here is the diff before and after the deletion:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>Overall:
</span></span><span style=display:flex><span>     Device allocated:                  2884.02GiB
</span></span><span style=display:flex><span>     Device unallocated:                2693.98GiB
</span></span><span style=display:flex><span>     Device missing:                       0.00GiB
</span></span><span style=display:flex><span><span style=color:#f92672>-    Used:                              2843.89GiB
</span></span></span><span style=display:flex><span><span style=color:#f92672>-    Free (estimated):                  2732.34GiB      (min: 1385.35GiB)
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+    Used:                              2842.04GiB
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    Free (estimated):                  2734.20GiB      (min: 1387.21GiB)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>     Data ratio:                              1.00
</span></span><span style=display:flex><span>     Metadata ratio:                          2.00
</span></span><span style=display:flex><span>     Global reserve:                       0.28GiB      (used: 0.00GiB)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>-Data,single: Size:2880.01GiB, Used:2841.64GiB
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+Data,single: Size:2880.01GiB, Used:2839.79GiB
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>    /dev/mapper/cachedev_0      2880.01GiB
</span></span></code></pre></div><h2 id=how-to-install>How to install<a hidden class=anchor aria-hidden=true href=#how-to-install>#</a></h2><p>Nothing more simple than to use the <a href=https://github.com/garnajee/removarr/blob/master/docker-compose.yml>docker-compose</a> file.</p><ul><li>First option: (like the example above) you have <strong>one</strong> folder for all your media, use <a href=https://github.com/garnajee/removarr/blob/master/docker-compose.yml>this file</a>:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.9&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>removarr</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>ghcr.io/garnajee/removarr:latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>removarr</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PUID=1030</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PGID=100</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/completed/:/data/completed&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/medias/:/data/medias&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;127.0.0.1:8012:5000&#39;</span>
</span></span></code></pre></div><ul><li>Second option: you have several folders not in the same place, use <a href=https://github.com/garnajee/removarr/blob/master/docker-compose-2.yml>this file</a>:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.9&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>removarr</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>ghcr.io/garnajee/removarr:latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>removarr</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PUID=1030</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PGID=100</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/completed/:/data/completed&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/movies/:/data/movies&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/series/:/data/series&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;127.0.0.1:8012:5000&#39;</span>
</span></span></code></pre></div><p>The application will be available at <code>&lt;you_ip>:8012</code>.</p><ul><li>User/Group Identifiers</li></ul><p>UserID (<code>PUID</code>) and GroupID (<code>PGID</code>) are optionals. To find these ids just type <code>id &lt;username></code> as below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ id username
</span></span><span style=display:flex><span>    uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>dockeruser<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>dockergroup<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>dockergroup<span style=color:#f92672>)</span>
</span></span></code></pre></div><ul><li>Volumes</li></ul><p><code>/tmp/test/completed/</code>: change this by the path of your download folder</p><p><code>/tmp/test/medias/</code> : change this by the path of your medias folder</p><ul><li>Port</li></ul><p><code>8012</code>: change this port to suit your needs.</p><h2 id=todo>Todo<a hidden class=anchor aria-hidden=true href=#todo>#</a></h2><ul><li><input checked disabled type=checkbox> modify README (setup installation, how to use, how to build, screenshot,&mldr;) - needs to be improved</li><li><input disabled type=checkbox> get hash of torrent file to delete it (need to mount one more volume)</li><li><input checked disabled type=checkbox> delete empty folder (ignore other files different than .mkv/avi/&mldr;)</li><li><input checked disabled type=checkbox> add total size of all files</li><li><input checked disabled type=checkbox> add size of each file in a column</li><li><input checked disabled type=checkbox> create a checkbox to delete multiples files at once</li><li><input checked disabled type=checkbox> create a button to delete all files at once => use the &ldquo;Select All&rdquo; button</li><li><input disabled type=checkbox> sort table by alphabetic order and file size</li><li><input disabled type=checkbox> add an &ldquo;unwanted&rdquo; button, hide files to avoid deleting them by mistake</li><li><input disabled type=checkbox> make the app more responsive</li></ul><h2 id=build>Build<a hidden class=anchor aria-hidden=true href=#build>#</a></h2><p>To build this application, follow these steps:</p><ul><li>build the Dockerfile: <code>$ docker build -t &lt;your_image_name> .</code></li><li>run the image: <code>$ docker run -p 5000:5000 -v /your/path/completed:/data/completed -v /your/path/medias:/data/medias &lt;your_image_name></code></li></ul><p>If you want to use a docker-compose.yml instead of the Dockerfile, then use this example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.9&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>removarr</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>build</span>: <span style=color:#ae81ff>.</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>removarr</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PUID=1030</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>PGID=100</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/completed/:/data/completed&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;/your/path/medias/:/data/medias&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;127.0.0.1:8012:5000&#39;</span>
</span></span></code></pre></div><ul><li>you can now build this docker-compose.yml: <code>$ docker-compose build</code></li><li>and finally, run: <code>$ docker-compose up -d</code></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/removarr/>Removarr</a></li><li><a href=http://localhost:1313/tags/flask/>Flask</a></li><li><a href=http://localhost:1313/tags/python/>Python</a></li><li><a href=http://localhost:1313/tags/server/>Server</a></li><li><a href=http://localhost:1313/tags/web/>Web</a></li><li><a href=http://localhost:1313/tags/app/>App</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/infomanip/><span class=title>« Prev</span><br><span>Real-time detection of information manipulation - Computational Influence Struggle (L2I).</span>
</a><a class=next href=http://localhost:1313/posts/home-server/><span class=title>Next »</span><br><span>Home Server</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Garnajee</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>